<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DOM-Based XSS Secure</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <h1>DOM-Based XSS Secure Demo</h1>

    <nav>
      <ul>
        <a href="reflectedXSS.html">Reflected XSS Vulnerable</a>
      </ul>
      <ul>
        <a href="storedXSS.html">Stored XSS Vulnerable</a>
      </ul>
      <ul>
        <a href="domXSS.html">DOM XSS Vulnerable</a>
      </ul>
      <ul>
        <a href="reflectedXSS_Secure.html">Reflected XSS Securee</a>
      </ul>
      <ul>
        <a href="storedXSS_Secure.html">Stored XSS Secure</a>
      </ul>
    </nav>

    <p>
      After entering the below code in the url, refresh the page to see output.
    </p>

    <p>Output from URL hash (#):</p>
    <div id="domOutput"></div>
    <code
      >#message=&lt;img src=x onerror=&quot;alert('DOM XSS!')&quot;&gt;</code
    >
    <p>
      Enter the above code:
      <code
        >#message=&lt;img src=x onerror=&quot;alert('DOM XSS!')&quot;&gt;</code
      >
      after html in the url.
    </p>

    <script>
      console.log("Secure DOM-based XSS script is running.");

      const hash = window.location.hash.substring(1);
      const params = new URLSearchParams(hash);
      const message = params.get("message");

      if (message) {
        //Using textContent rather than innerHTML
        document.getElementById("domOutput").textContent = message;
      }
    </script>
  </body>
</html>
