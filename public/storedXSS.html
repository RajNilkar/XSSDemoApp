<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stored XSS Demo</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <h1>Stored XSS Demo</h1>

    <nav>
        <ul><a href="reflectedXSS.html">Reflected XSS</a></ul>
        <ul><a href="storedXSS.html">Stored XSS</a></ul>
        <ul><a href="domXSS.html">DOM XSS</a></ul>
    </nav>


    <div id="inputbox-container">
        <form onsubmit="saveComment(event)">
            <label for="comment">Leave a comment:</label>
            <input type="text" id="commentInput" placeholder="Add a comment...">
            <button type="submit" id="submitBtn">Save</button>
        </form>
    </div>

    <h2>Comments:</h2>
    <div id="comments"></div>

    <script>
        function loadComments() {
            const comments = JSON.parse(localStorage.getItem("comments")) || [];
            const container = document.getElementById("comments");

            container.innerHTML = ""; //Reset the pop-up on page reload
            
            comments.forEach(comment=> {
                // Vulnerable to XSS: injecting unsanitized HTML directly
                const commentDiv = document.createElement("div");
                commentDiv.innerHTML = comment;
                container.appendChild(commentDiv);
            });
        }

        function saveComment(event) {
            event.preventDefault();

            const userInput = document.getElementById("commentInput");
            const value = userInput.value.trim();
            
            if(!value) return;

            const comments = JSON.parse(localStorage.getItem("comments")) || [];
            comments.push(userInput);

            localStorage.setItem("comments", JSON.stringify(comments));
        
            userInput.value = ""; //Clear the input field
            loadComments(); //Reload without page refresh
        }

        //Load XSS payloads
        loadComments();
    </script>
</body>
</html>